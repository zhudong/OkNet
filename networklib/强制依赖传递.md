# 强制依赖传递方案

## 问题背景

默认情况下，AAR包不会传递其compile依赖，导致使用AAR的项目还需要手动添加所有依赖。

## 解决方案：使用api替代implementation

### 修改方法

在 `networklib/build.gradle` 中，将关键依赖从 `implementation` 改为 `api`：

```gradle
dependencies {
    // 保持implementation（不传递）
    implementation libs.appcompat

    // 改为api（强制传递）
    api 'com.lzy.net:okgo:3.0.4'
    api 'com.lzy.net:okserver:2.0.5'
    api 'com.google.code.gson:gson:2.8.1'
}
```

### 重新打包

```bash
gradlew :networklib:clean :networklib:assembleRelease
```

### 使用效果

现在其他项目只需要添加AAR就可以了：

```gradle
dependencies {
    // 只需要这一行，所有依赖都会自动传递
    implementation files('libs/networklib-release.aar')
}
```

可以直接使用：
```java
import com.lzy.okgo.model.Response; // ✅ 可以直接使用
import com.google.gson.Gson;         // ✅ 可以直接使用
```

## api vs implementation

### implementation（默认）
- 依赖不会传递给使用该library的项目
- 推荐用于内部实现细节

### api（强制传递）
- 依赖会传递给使用该library的项目
- 推荐用于暴露给用户的API

### 适用场景

**使用api的情况：**
- Library的核心功能依赖（如OkGo、Gson）
- 用户需要直接使用的类（如Response、Gson）

**使用implementation的情况：**
- 内部工具库
- 不暴露给用户的实现细节

## 优缺点

### 优点
- 使用简单，只需要添加AAR
- 自动管理依赖版本

### 缺点
- 可能导致依赖版本冲突
- 强制用户使用特定版本
- 减少了用户的灵活性

## 推荐做法

1. **核心依赖使用api**：OkGo、Gson等核心功能依赖
2. **可选依赖使用implementation**：内部工具库
3. **在文档中说明**：告知用户哪些依赖会被传递

## 验证方法

打包后，可以检查AAR的pom.xml文件，确认依赖是否正确声明：

```xml
<dependencies>
  <dependency>
    <groupId>com.lzy.net</groupId>
    <artifactId>okgo</artifactId>
    <version>3.0.4</version>
    <scope>compile</scope>
  </dependency>
  <!-- 其他依赖 -->
</dependencies>
```

然后在测试项目中，只添加AAR，不添加其他依赖，验证是否能正常编译和运行。
